#!/bin/bash

echo "üöÄ GU√çA PARA DESPLEGAR A PRODUCCI√ìN"
echo "=================================="
echo ""
echo "üéØ PROBLEMA IDENTIFICADO:"
echo "Tu servidor de producci√≥n (https://api.tradeoptix.app) solo tiene la ruta /health"
echo "Las rutas de admin (/api/v1/admin/news, /api/v1/admin/notifications) NO existen"
echo ""
echo "‚úÖ CORS est√° configurado correctamente en producci√≥n"
echo "‚ùå Las rutas de la aplicaci√≥n NO est√°n desplegadas"
echo ""
echo "üî• SOLUCI√ìN: DESPLEGAR EL C√ìDIGO ACTUAL A PRODUCCI√ìN"
echo ""
echo "üìã PASOS PARA DEPLOYMENT:"
echo ""
echo "1. COMPILAR LA APLICACI√ìN:"
echo "   make build"
echo ""
echo "2. SUBIR AL SERVIDOR (usando la IP que encontramos):"
echo "   # IP del servidor: 194.163.133.7"
echo "   scp bin/tradeoptix-server usuario@194.163.133.7:/ruta/del/servidor/"
echo ""
echo "3. CONFIGURAR VARIABLES DE ENTORNO EN PRODUCCI√ìN:"
echo "   # Crear .env en el servidor con:"
cat << 'EOF'
PORT=8080
ENVIRONMENT=production
DATABASE_URL=postgresql://tradeoptix_user:nrdys53kzx8amg50@tradeoptix-dbprincipal-exnswt:5432/tradeoptix_db?sslmode=disable
JWT_SECRET=dJxPh6PwKyyZcVRnVkbzMY51SftP37fy
ALLOWED_ORIGINS=https://admin.tradeoptix.app,https://app.tradeoptix.app,https://tradeoptix.app
EOF
echo ""
echo "4. REINICIAR EL SERVICIO EN PRODUCCI√ìN:"
echo "   systemctl restart tradeoptix-server"
echo "   # o el comando que uses para reiniciar"
echo ""
echo "üîß ALTERNATIVAS DE DEPLOYMENT:"
echo ""
echo "A. DOCKER:"
echo "   docker build -t tradeoptix-backend ."
echo "   docker push tu-registry/tradeoptix-backend"
echo "   # Deploy en el servidor"
echo ""
echo "B. CI/CD (GitHub Actions, etc):"
echo "   - Push to main branch"
echo "   - Automatic deployment"
echo ""
echo "C. SERVIDOR LOCAL EXPUESTO:"
echo "   # Si quieres usar tu servidor local temporalmente:"
echo "   # Configurar reverse proxy (nginx) o tunnel"
echo ""
echo "üí° VERIFICACI√ìN POST-DEPLOYMENT:"
echo "curl -s https://api.tradeoptix.app/api/v1/admin/news"
echo "# Deber√≠a devolver data, no 404"
echo ""
echo "üéØ RESULTADO ESPERADO:"
echo "Una vez desplegado, https://admin.tradeoptix.app funcionar√° completamente"